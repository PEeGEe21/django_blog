{% extends "blog/base.html" %}
{% load crispy_forms_tags %}
{% block title %} {{ user.username|lower }}'s profile {% endblock %}

    {% block content %}
    
    <!-- <div class="main-content">

        <div class="page-content">
            <div class="container-fluid">




                <div class="content-section">
                    <div class="media">
                        <img class="rounded-circle account-img" src="{{ user.profile.image.url }}" />
                        <div class="media-body">
                            <h2 class="account-heading">{{ user.username }}</h2>
                            <p class="text-secondary">{{ user.email }}</p>
                        </div>
                    </div>
                    <form method="POST" enctype="multipart/form-data">
                        {% csrf_token %}
                        <fieldset class="form-group">
                            <legend class="border-bottom mb-4">
                                Profile Info
                            </legend>
                            {{ u_form|crispy }}
                            {{ p_form|crispy }}
                        </fieldset>
                        <div class="form-group">
                            <button class="btn btn-outline-info" type="submit">Update</button>
                        </div>
                    </form>

                </div>
            </div>
        </div>
    </div> -->
    
    <div class="main-content">

        <div class="page-content">
            <div class="container-fluid">

                <!-- start page title -->
                <div class="row">
                    <div class="col-12">
                        
                <!-- end page title -->


                        <div class="card shadow-sm profile-header p-0"> 
                            <div class="cover-image rounded-top border-bottom border-sm" data-image-src="{{ user.profile.coverimage.url }}"></div>
                            <div class="card-body pb-5">
                                <div class="text-center d-flex align-items-center justify-content-between">
                                        <img src="{{ user.profile.image.url }}" class="img-fluid user-avatar large-avatar rounded-circle mt-n7 mb-4" alt="{{teacher.username}}">
                                        
                                        <a href="{% url 'profile_edit' %}" class="btn btn-dark rounded-top mt-n6">Edit Profile</a>
                                </div>
                                <div>
                                    <h4 class="h3">{{ user.profile.displayname }}</h4>
                                    <h5 class="fw-normal mb-4"><span>@</span>{{ user.username }}</h5>
                                </div>
                                <div class="bio-text">
                                    <p class="fw-normal mb-">{{ user.profile.bio }}</p>

                                    <div class="d-flex align-items-center ">
                                        {% if user.profile.birthday %}
                                                <p class="fw-normal mb-4 mr-3 "><i class="la la-birthday-cake mr-1"></i>
                                                    <span>Born </span>{{ user.profile.birthday|date:'F d, Y' }}
                                                </p>
                                            {% else %}
                                                <p class="fw-normal mb-4 mr-3 ">
                                                    <i class="la la-birthday-cake mr-1"></i><span>{{ user.username }} </span>add your Birthday!!
                                                </p>
                                            {% endif %}
                                        <!-- <p class="fw-normal mb-4 mr-3"><i class="la la-birthday-cake mr-1"></i><span>Joined </span>{{ user.profile.birthday|date:'F d, Y' }}</p> -->

                                        <p class="fw-normal mb-4"><i class="far fa-calendar-alt mr-2"></i><span>Joined </span>{{ user.date_joined|date:'F Y' }}</p>
    
                                    </div>
                                    
                                    <h6 class="text-muted">
                                        {{ user.profile.followers.count }}<a href="{% url 'follower_list' %}" ><span class="text-muted"> Follower{{ user.profile.followers.count|pluralize }}</span></a>
                                    </h6>
                                    <span class="text-muted">{{post_count}} <a href="{% url 'user-posts' user.username %}" class="text-muted">Post{{ post_count|pluralize }}</a></span>

                                    <!-- <p class="fw-normal mb-4">{{ user.date_joined }}</p> -->
                                </div>
                            </div>
                        </div>

                        
                        <!-- <div class="card shadow-sm p-0"> -->
                            <!-- <div class="card-body pb-5"> -->

                                <div class="kt-portlet__body">
                                    <ul class="nav nav-pills nav-fill mb-3" role="tablist">
                                        <li class="nav-item">
                                            <a class="nav-link active" data-toggle="tab" href="#posts">Posts</a>
                                        </li>
                                        <li class="nav-item">
                                            <a class="nav-link" data-toggle="tab" href="#posts_and_comments">Posts &amp; Comments</a>
                                        </li>
                                        <li class="nav-item">
                                            <a class="nav-link" data-toggle="tab" href="#likes">Likes</a>
                                        </li>
                                    </ul>
                                    <div class="tab-content">
                                        <div class="tab-pane active" id="posts" role="tabpanel">
                                            {% if not user_posts %}
                                            <div class="text-center mx-auto" >
                                                <h3 class="">No posts yet</h3>
                                            </div>
                                                

                                            {% else %}

                                                {% for user_posts in user_posts %}
                                                    <article class="media content-section kt-portlet ">
                                                        <img class="rounded-circle article-img" src="{{ user_posts.author.profile.image.url }}" />
                                                        <div class="media-body">
                                                            <div class=" kt-portlet__head">
                                                                <div class="kt-portlet__head-label">
                                                                    <h3 class="kt-portlet__head-title align-items-center">
                                                                        {{ user_posts.author.profile.displayname }}
                                                                        <a class="mr-2" href=""><span>@</span>{{ user_posts.author }}</a>
                                                                        <small class="text-muted">{{ user_posts.date_posted|date:'m D, Y' }}</small>
                                                                    </h3> 
                                                                </div>
                                                                <div class="dropdown float-right position-relative">
                                                                    <a href="#" class="dropdown-toggle h4 text-muted" data-toggle="dropdown"
                                                                        aria-expanded="false">
                                                                        <i class="fas fa-ellipsis-v"></i>
                                                                    </a>
                                                                    <ul class="dropdown-menu dropdown-menu-right">
                                                                        <!-- <li><a href="#" class="dropdown-item">Not interested in this post</a></li> -->
                                                                        <!-- <li class="dropdown-divider"></li> -->
                                                                        
                                                                        
                                                                        {% if user_posts.author == user %}
                                                                            <li><a class="dropdown-item" href="{% url 'post-update' user_posts.id %}">Edit Post</a></li>
                                                                            <li><a class="dropdown-item" href="{% url 'post-delete' user_posts.id %}">Delete Post</a></li>
                                                                        {% else %}
                                                                            <li><a href="#" class="dropdown-item">Follow <span>@</span>{{user_posts.author}}</a></li>
                                                                            <li><a href="#" class="dropdown-item">Mute <span>@</span>{{user_posts.author}}</a></li>
                                                                            <li><a href="#" class="dropdown-item">Block <span>@</span>{{user_posts.author}}</a></li>
                                                                            <li class="dropdown-divider"></li>
                                                                            <li><a href="#" class="dropdown-item">Report Post</a></li>
                                        
                                                                        {% endif %}
                                                                    </ul>
                            
                                                                    
                                                                </div>
                                                            </div>

                                                            <div class="mt-3">
                                                                <h2>
                                                                    <a class="article-title" href="{% url 'post-detail' user_posts.id %}">{{ user_posts.title|safe }}</a>
                                                                </h2>
                                                                <a class="article-title" href="{% url 'post-detail' user_posts.id %}"><p class="article-content">{{ user_posts.content }}</p></a>
                                                                <div class="action-btns d-flex text-center justify-content-around align-items-center mx-auto" >
                                                                    <a class="d-flex align-items-center btn justify-content-around" href="/post/{{user_posts.id}}/#comment">
                                                                        <i class="far fa-comment-alt icons"></i><span class="ml-2">{{ user_posts.number_of_comments }}</span>
                                                                    </a>
                            
                                                                    <button class="btn">
                                                                        <i class="fa fa-retweet icons"></i>
                                                                    </button class="btn">

                                        {% if user.is_authenticated %}

                                        
                                            <form action="{% url 'like_post' %}" method="POST" id="{{user_posts.id}}" class="like-form "> 
                                                {% csrf_token %}
                                                <input type="hidden" name="post_id" value={{user_posts.id}}>
                    
                                                <button type="submit" name="post_id" value="{{user_posts.id}}" class="btn d-flex align-items-center like-btn{{user_posts.id}}">
                                                    <i class="far fa-heart icons like-btn{{user_posts.id}}"></i><span class="ml-2 like-count{{user_posts.id}}">{{ user_posts.num_likes }}</span>
                                                </button>
                                            </form>

                                        {% else %}
                                            <button name="post_id" value="{{user_posts.id}}" class="btn d-flex align-items-center like-btn{{post.id}}">
                                                <!-- {% if request.user in post_obj.liked.all %} -->
                                                    <!-- <i class="fas fa-heart icons" style="color:rgba(252, 63, 63, 0.979)"></i><span class="ml-2">{{ object.num_likes }}</span> -->
                                                <!-- {% else %} -->
                                                    <!-- <i class="far fa-heart icons"></i><span class="ml-2">{{ total_likes }}</span> -->
                                                    <i class="far fa-heart icons like-btn{{user_posts.id}}"></i><span class="ml-2 like-count{{user_posts.id}}">{{ user_posts.num_likes }}</span>
                                                <!-- {% endif %} -->
                                            </button>
                                        {% endif %}

                                                                    <button class="btn" id="{{user_posts.id}}" data-toggle="modal" data-target="#sharemodal-{{user_posts.id}}">
                                                                        <i class="fas fa-share-alt icons "></i>
                                                                    </button>
                                                                </div>
                                                            </div>
                                                            
                                                            
                                                        </div>                   
                                                    </article>


                                                    <div class="modal fade" id="sharemodal-{{user_posts.id}}" tabindex="-1" role="dialog" aria-labelledby="modalTitle" aria-hidden="true">
                                                        <div class="modal-dialog modal-dialog-centered" role="document">
                                                            <div class="modal-content">
                                                                
                                                                <div class="modal-header">
                                                                    <h5 class="modal-title text-center" id="modalLongTitle">
                                                                        Share <span>Your</span> Post
                                                                    </h5>
                                                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                                        <span aria-hidden="true">&times;</span>
                                                                    </button>
                                                                </div>
                                                                <div class="modal-body">
                                                                    <div class="pt-3">
                                                                            <!-- <button type="button" class="" data-toggle="modal" data-target="#coursemodal"> -->
                                                                                <a href="">
                                                                                    <i class="fas fa-bookmark share-icons"></i>
                                                                                    <span class="ml-1">Bookmarks</span>
                                                                                </a>
                                                                                <a href="" class="">
                                                                                    <i class="fas fa-link share-icons"></i>
                                                                                    <span class="ml-1">Copy Link</span>
                                                                                </a>
                                                                                <a href="">
                                                                                    <i class="fas fa-share-alt share-icons"></i>
                                                                                    <span class="ml-1">Share via</span>
                                                                                </a>
                                                                                
                                        
                                                                                
                                                                            <!-- </button> -->
                                                                    </div>
                                                                </div>
                                                                <div class="modal-body">
                                                                    <div class=" border-top border-sm pt-3">
                                                                        <a href="" target="_blank"><i class="fab fa-twitter share-icons"></i></a>
                                                                        <a href="" target="_blank"><i class="fab fa-facebook share-icons"></i></a>
                                                                        <!-- <a href="" target="_blank"><i class="fab fa-mail"></i></a> -->
                                                                        <a href="" target="_blank"><i class="fab fa-whatsapp share-icons"></i></a>
                                                                    </div>
                                                                </div>
                                                                
                                                                
                                                            </div>
                                        
                                                        </div>
                                        
                                                    </div>
                                                {% endfor %} 
                                            {% endif %}                                       
                                        </div>
                                        
                                        <div class="tab-pane" id="posts_and_comments" role="tabpanel">
                                            {% for user_comments in user_comments %}
                                            <article class="media content-section">
                                              <div class="media-body">
                                                <div class="article-metadata post-detail">
                                                  <a href="{{ user_comments.author.profile.get_absolute_url }}" >
                                                    <img class="rounded-circle article-img" alt="{{ comment.author }}" src="{{ user_comments.author.profile.image.url }}" />
                                                  </a>
                                                  <span class="h4">{{ user_comments.author.profile.displayname }}</span>
                                                  <span>@</span><a class="h6" href="{{ user_comments.author.profile.get_absolute_url }}">{{ user_comments.author }}</a>
                                                  replying <span>@</span><a class="mr-2 h6" href="">{{ object.author }}</a>
                                                  <!-- <small class="text-muted">{{ comment.date_added|date:'m D, Y' }}</small>    -->
                          
                                                  <div class="dropdown float-right position-relative mt-2">
                                                    <a href="#" class="dropdown-toggle h4 text-muted " data-toggle="dropdown"
                                                        aria-expanded="false">
                                                        <i class="fas fa-ellipsis-v"></i>
                                                    </a>
                                                    <ul class="dropdown-menu dropdown-menu-right">
                                                        <!-- <li><a href="#" class="dropdown-item">Not interested in this post</a></li> -->
                                                        <!-- <li class="dropdown-divider"></li> -->
                                                        
                                                        
                                                        {% if user_comments.author == user %}
                                                        <li class=""><a class="dropdown-header">Coming soon</a></li>
                                                          <li><a class="dropdown-item disabled" href="">Update Comment</a></li>
                                                          <li><a class="dropdown-item disabled" href="">Delete Comment</a></li>
                                                        {% else %}
                                                        <li><a href="#" class="dropdown-item">Follow <span>@</span>{{user_comments.author}}</a></li>
                                                        <li><a href="#" class="dropdown-item">Mute <span>@</span>{{user_comments.author}}</a></li>
                                                        <li><a href="#" class="dropdown-item">Block <span>@</span>{{user_comments.author}}</a></li>
                                                        <li class="dropdown-divider"></li>
                                                        <li><a href="#" class="dropdown-item">Report Comment</a></li>
                          
                                                        {% endif %}
                                                    </ul>
                                                  </div>
                                                </div>
                          
                          
                                                <div class="border-bottom border-sm">
                          
                                                  <!-- <h2 class="article-title">{{ object.title }}</h2> -->
                                                  <p class="article-content">{{  user_comments.content|safe  }}</p>
                          
                                                  <small class="text-muted">{{ user_comments.date_added|date:'d M, Y' }}</small>
                                                </div>
                                                  <div class="action-btns d-flex text-center justify-content-around align-items-center mx-auto" >
                                                    <!-- <a data-toggle="collapse" href="#collapseExample" aria-expanded="false" aria-controls="collapseExample"> -->
                                                        <i class="fas fa-comment-alt icons"></i>
                                                    <!-- </a> -->
                                                    <i class="fa fa-retweet icons"></i>
                                                    <i class="fa fa-heart icons"></i>
                          
                                                    <button class="btn" id="{{user_comments.id}}" data-toggle="modal" data-target="#sharemodal-{{user_comments.id}}">
                                                      <i class="fas fa-share-alt icons "></i>
                                                    </button>
                                                  </div>
                                              </div>
                                            </article>
                                            <!--Comment Share Modal-->
                                            <div class="modal fade" id="sharemodal-{{user_comments.id}}" tabindex="-1" role="dialog" aria-labelledby="modalTitle" aria-hidden="true">
                                              <div class="modal-dialog modal-dialog-centered" role="document">
                                                  <div class="modal-content">
                                                      
                                                      <div class="modal-header">
                                                          <h5 class="modal-title text-center" id="modalLongTitle">
                                                              <!-- Share <span>@</span>{{comment.author}}'s Comment -->
                                                              {% if comment.author == user %}
                                                                Share <span>Your</span> Comment
                                                              {% else %}
                                                                  Share <span>@</span>{{user_comments.author}}'s Comment
                                                              {% endif %}
                                                          </h5>
                                                          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                              <span aria-hidden="true">&times;</span>
                                                          </button>
                                                      </div>
                                                      <div class="modal-body">
                                                          <div class="pt-3">
                                                                  <!-- <button type="button" class="" data-toggle="modal" data-target="#coursemodal"> -->
                                                                      <a href="">
                                                                          <i class="fas fa-bookmark share-icons"></i>
                                                                          <span class="ml-1">Bookmarks</span>
                                                                      </a>
                                                                      <a href="" class="">
                                                                          <i class="fas fa-link share-icons"></i>
                                                                          <span class="ml-1">Copy Link</span>
                                                                      </a>
                                                                      <a href="">
                                                                          <i class="fas fa-share-alt share-icons"></i>
                                                                          <span class="ml-1">Share via</span>
                                                                      </a>
                                                                      
                          
                                                                      
                                                                  <!-- </button> -->
                                                          </div>
                                                      </div>
                                                      <div class="modal-body">
                                                          <div class=" border-top border-sm pt-3">
                                                              <a href="" target="_blank"><i class="fab fa-twitter share-icons"></i></a>
                                                              <a href="" target="_blank"><i class="fab fa-facebook share-icons"></i></a>
                                                              <!-- <a href="" target="_blank"><i class="fab fa-mail"></i></a> -->
                                                              <a href="" target="_blank"><i class="fab fa-whatsapp share-icons"></i></a>
                                                          </div>
                                                      </div>
                                                      
                                                      
                                                  </div>
                          
                                              </div>
                          
                                            </div>
                                            {% endfor %}
                                        </div>
                                        <div class="tab-pane " id="likes" role="tabpanel">
                                            {% for post in posts %}
                                                <article class="media content-section kt-portlet ">
                                                    <img class="rounded-circle article-img" src="{{ post.author.profile.image.url }}" />
                                                    <div class="media-body">
                                                        <div class=" kt-portlet__head">
                                                            <div class="kt-portlet__head-label">
                                                                <h3 class="kt-portlet__head-title align-items-center">
                                                                    {{ post.author.profile.displayname }}
                                                                    <a class="mr-2" href=""><span>@</span>{{ post.author }}</a>
                                                                    <small class="text-muted">{{ post.date_posted|timesince }}</small>
                                                                    <!-- <small class="text-muted">{{ post.date_posted|date:"F d, Y" }}</small> -->
                                                                </h3>
                                                                
                                                        
                                                                
                                                            </div>
                                                            <div class="dropdown float-right position-relative">
                                                                <a href="#" class="dropdown-toggle h4 text-muted" data-toggle="dropdown"
                                                                    aria-expanded="false">
                                                                    <i class="fas fa-ellipsis-v"></i>
                                                                </a>
                                                                <ul class="dropdown-menu dropdown-menu-right">
                                                                    <li><a href="#" class="dropdown-item">Action</a></li>
                                                                    <li><a href="#" class="dropdown-item">Another action</a></li>
                                                                    <li><a href="#" class="dropdown-item">Something else here</a></li>
                                                                    <li class="dropdown-divider"></li>
                                                                    <li><a href="#" class="dropdown-item">Separated link</a></li>
                                                                </ul>
                                                            </div>
                                                            
                                                        </div>
                                                        <div class="mt-3">
                                                            <h2>
                                                                <a class="article-title" href="{% url 'post-detail' post.id %}">{{ post.title }}</a>
                                                            </h2>
                                                            <a class="article-title" href="{% url 'post-detail' post.id %}"><p class="article-content">{{ post.content }}</p></a>
                                                            <div class="action-btns d-flex text-center justify-content-around align-items-center mx-auto" >
                                                                <!-- <a data-toggle="collapse" href="#collapseExample" aria-expanded="false" aria-controls="collapseExample"> -->
                                                                <!-- <a href="{% url 'post-detail' post.id %}" class="d-flex align-items-center">
                                                                    <i class="fas fa-comment-alt icons"></i><span class="ml-1">{{ comments }}</span> 
                                                                </a> -->
                                                                <button class="btn">
                                                                    <i class="fas fa-comment-alt icons"></i>
                                                                </button>

                                                                <button class="btn">
                                                                    <i class="fa fa-retweet icons"></i>

                                                                </button class="btn">
                                                                    <button class="btn">
                                                                                <i class="fa fa-heart icons"></i> 
                                                                    </button>
                                                                <button class="btn">
                                                                    <i class="fas fa-share-alt icons "></i>

                                                                </button>
                                                            </div>
                                                        </div>
                                                        
                                                        
                                                    </div>                   
                                                </article>
                                                    <div class="mb-4">
                                                        <div class="collapse" id="collapseExample">
                                                            <div class="">
                                                                Anim pariatur cliche reprehenderit, enim eiusmod high life accusamus terry richardson ad squid. Nihil anim keffiyeh helvetica, craft beer labore wes anderson cred nesciunt sapiente ea proident.
                                                            </div>
                                                        </div>
                                                    </div> 
                                            {% endfor %}
                                        </div>
                                    </div>
                                </div>



                            <!-- </div> -->
                          <!-- </div> -->
        
        
                   </div> <!-- end col -->
                   
                </div>
                <!-- end row-->

                
                <!-- end row-->

            </div> <!-- container-fluid -->
        </div>
        <!-- End Page-content -->

        {% if user.is_authenticated %}
        <div>
            <!-- <button type="button" class="" data-toggle="modal" data-target="#coursemodal"> -->
                <a href="{% url 'post-create' %}">
                    <i class="fas fa-plus add_new"></i>
                </a>
                
            <!-- </button> -->
        </div>
        {% endif %}
    </div>


   {% endblock content %}